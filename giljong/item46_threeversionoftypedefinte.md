# 라이브러리의 전이적(tran-sitive) 의존성 호환 여부

그리고 타입스크립트는 런타임 오버헤드 0을 표방하는 언어이며

트랜스파일링 후에는 자바스크립트 파일이 되어 런타임에 영향을 주지 않기 때문에

일반적으로 devdep에 속하게됩니다.

그런데 우리는 devdep, dep, peerdep은 어느정도 신경쓰지만

라이브러리의 tran-sitive 의존성 호환 여부는 크게 신경쓰지 않았습니다.

그럼 전이적 의존성(tran-sitive-dependency) 호환여부란 뭘까요?

# 전이적 종속성

TypeScript와 npm의 맥락에서 "전이적 종속성" 이라는 개념은

프로젝트의 종속성에 필요한 종속성을 나타냅니다.

약간의 오개념으로 작용할 수도 있지만 전이적 종속성을

종속성의 전이가 발생하는 현상 자체를 의미한다고 보아도 좋을 것 같습니다.

<br/>

라이브러리 A 가 라이브러리 B에 종속되고 라이브러리 B가 라이브러리 C에 종속되면 

라이브러리 C는 라이브러리 A의 전이적 종속성입니다.

이런 전이적 종속성은 패키지 관리자(npm , yarn 등)에 의해 자동으로 설치됩니다.

# 전이적 종속성과 peerdependency

개인적으로 이 둘이 같은 것이 아닌가? 보는 관점의 차이가 아닌가?

하는 궁금증이 있었습니다.

그러나 이 둘은 유사해보이는 공통점을 일부 공유할 뿐 다른 개념입니다.

## peerdependency

피어종속성은 두 패키지 간의 협업을 보장하는 데 사용되는 개념입니다.

두 패키지가 제대로 작동하기 위해 동일한 라이브러리 인스턴스를 공유해야 할 때 사용됩니다.

즉 피어종속성은 **서로 직접적인 연관관계가 있는 경우의 종속성**을 의미합니다.

따라서 피어 종속성은 두 패키지 간의 긴밀한 협력을 의미하게 됩니다.

즉 라이브러리 A,B,C가 있다고 가정하였을 때

A,B가 서로 피어디펜던시이고 B,C가 서로 피어디펜던시인

일종의 피어디펜던시체인이 형성되었다고 하더라도

이를 전이적 종속성이라고 볼 수는 없습니다.




<br/>

또한 피어종속성과 전이적종속성의 가장 직관적인 차이 중 하나는

피어종속성은 패키지 관리자가 자동으로 설치해주지 않고 직접 명시적으로 관리해야하지만

전이적종속성은 패키지 관리자가 자동으로 관리해준다는 것입니다.

<br/>

이러한 peerdependency는

종속성이 하나의 체인 형태가 되어 전이되며

자동으로 관리되는 전이적 종속성과는 개념적으로 다릅니다.

# 타입스크립트에서 추가로 고려해야하는 의존성

타입스크립트에서는 자바스크립트에선 하지 않았던 3가지의 고려사항이 추가됩니다.

1. 라이브러리 버전

2. 타입 선언(@types)의 버전

3. 타입스크립트의 버전

이 세가지 중 하나라도 맞지 않으면 엉뚱한 오류가 발생할 수 있습니다.

# 버전이 꼬이는 3가지 상황

1. 타입 선언 버전이 라이브러리 버전보다 높은 경우

2. 라이브러리 버전이 타입 선언 버전보다 높은 경우

3. 라이브러리에서 요구하는 타입스크립트 버전이 최신인 경우


# 마치며

@types 의존성이 중복되는 경우 npm이 중첩된 폴더에 별도로 해당 버전을 설치하여

문제를 해결하려고 한다는 부분이 매우 흥미로웠습니다.

```
node_modules/
  @types/
    foo/
      index.d.ts @1.2.3
    bar/
      index.d.ts
      node_modules/
        @types/
          foo/
            index.d.ts @2.3.4
```

위 폴더구조에서 @types/foo 폴더는 중복되어 정의되고 있습니다.

@types/bar 라이브러리가 @types/foo 라이브러리에 의존하기는 하지만

현재 프로젝트의 @types/foo 버전이 아닌 다른 버전에 의존한다면

하위에 node_modules 폴더를 또 생성하고 해당 버전을 설치하여 문제를 해결하려고 합니다.


<br/>

다만.. 많이 와닿지는 않네요..

애초에 @types 를 이용해야했던 경우는 보일러플레이트가 다 처리를 해놔서 그런 것 같습니다.

라이브러리 사용을 많이 안하다보니 그런 것 같네요
